<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimpleDLC - –ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–∞–Ω–Ω–µ—Ä–∞ –ø–æ–¥–ø–∏—Å–∫–∏ */
        .subscription-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }
        
        .subscription-modal {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalAppear 0.5s ease-out;
        }
        
        @keyframes modalAppear {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        .subscription-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #ff4757, #ff6b81);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 32px;
        }
        
        .subscription-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }
        
        .subscription-message {
            color: #666;
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 20px;
        }
        
        .channel-name {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            margin: 10px 0;
            font-size: 18px;
        }
        
        .subscription-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }
        
        .subscription-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
        }
        
        .btn-open {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-open:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-check {
            background: #f8f9fa;
            color: #667eea;
            border: 2px solid #e9ecef;
        }
        
        .btn-check:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        
        .subscription-note {
            font-size: 14px;
            color: #888;
            margin-top: 20px;
            line-height: 1.4;
        }
        
        .hidden {
            display: none !important;
        }
        
        .loader-small {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .subscription-status {
            font-size: 14px;
            color: #666;
            margin-top: 10px;
            min-height: 20px;
        }
        
        .status-success {
            color: #2ed573;
            font-weight: 600;
        }
        
        .status-error {
            color: #ff4757;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- –ë–∞–Ω–Ω–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏ -->
    <div id="subscriptionOverlay" class="subscription-overlay">
        <div class="subscription-modal">
            <div class="subscription-icon">üîí</div>
            <div class="subscription-title">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞</div>
            <p class="subscription-message">
                –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞—Ç–∞–ª–æ–≥—É –∏–≥—Ä –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–º –Ω–∞—à–µ–≥–æ –∫–∞–Ω–∞–ª–∞
            </p>
            <div class="channel-name">@SimpleDLC</div>
            
            <div class="subscription-status" id="subscriptionStatus">
                –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞—à —Å—Ç–∞—Ç—É—Å...
            </div>
            
            <div class="subscription-buttons">
                <button onclick="openChannel()" class="subscription-btn btn-open">
                    <i class="fas fa-external-link-alt"></i> –û—Ç–∫—Ä—ã—Ç—å –∫–∞–Ω–∞–ª
                </button>
                <button onclick="checkSubscription()" class="subscription-btn btn-check" id="checkBtn">
                    <i class="fas fa-sync-alt"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                </button>
            </div>
            
            <p class="subscription-note">
                –ü–æ—Å–ª–µ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å" –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
            </p>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å–∞–π—Ç–∞ -->
    <header class="header">
        <div class="logo">
            <h1 class="logo-text">SimpleDLC</h1>
        </div>
        <div class="theme-switcher">
            <span class="theme-label">–¢–µ–º–∞</span>
            <label class="switch">
                <input type="checkbox" id="themeToggle">
                <span class="slider"></span> 
            </label>
        </div>
    </header>

    <section class="search-section">
        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –∏–≥—Ä..." id="searchInput"> 
        </div>      
    </section>

    <main class="main-content">
        <div class="games-container" id="gamesContainer">
            <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä...</div>
        </div>
    </main>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const BOT_TOKEN = '5718405917:AAEtLH8r_FEh98utTX7-1iSRBBifbMJ0REY'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω
        const CHANNEL_USERNAME = '@SimpleDLC';
        
        let telegramUser = null;
        let isSubscribed = false;
        let checkInProgress = false;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        function initTelegram() {
            if (typeof window.Telegram !== 'undefined' && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                telegramUser = tg.initDataUnsafe?.user;
                tg.expand();
            } else {
                // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ –≤ Telegram, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                document.getElementById('subscriptionStatus').innerHTML = 
                    '<span class="status-error">–û—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞</span>';
                return;
            }
            
            // –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∫–∏
            checkSubscription();
            
            // –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(checkSubscription, 30000);
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
        async function checkSubscription() {
            if (checkInProgress) return;
            checkInProgress = true;
            
            const statusElement = document.getElementById('subscriptionStatus');
            const checkBtn = document.getElementById('checkBtn');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            checkBtn.innerHTML = '<span class="loader-small"></span>';
            checkBtn.disabled = true;
            
            if (!telegramUser) {
                statusElement.innerHTML = '<span class="status-error">–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>';
                checkBtn.innerHTML = '<i class="fas fa-sync-alt"></i> –ü–æ–≤—Ç–æ—Ä–∏—Ç—å';
                checkBtn.disabled = false;
                checkInProgress = false;
                return;
            }
            
            try {
                const response = await fetch(
                    `https://api.telegram.org/bot${BOT_TOKEN}/getChatMember`,
                    {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: CHANNEL_USERNAME,
                            user_id: telegramUser.id
                        })
                    }
                );
                
                const data = await response.json();
                
                if (data.ok) {
                    const status = data.result.status;
                    const subscribedStatuses = ['creator', 'administrator', 'member', 'restricted'];
                    
                    if (subscribedStatuses.includes(status)) {
                        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–ø–∏—Å–∞–Ω
                        isSubscribed = true;
                        statusElement.innerHTML = '<span class="status-success">‚úÖ –í—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã!</span>';
                        
                        // –ß–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã —Å–∫—Ä—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
                        setTimeout(() => {
                            document.getElementById('subscriptionOverlay').classList.add('hidden');
                            loadGames(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–≥—Ä—ã
                        }, 1500);
                        
                    } else {
                        // –ù–µ –ø–æ–¥–ø–∏—Å–∞–Ω
                        isSubscribed = false;
                        statusElement.innerHTML = '<span class="status-error">‚ùå –í—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –∫–∞–Ω–∞–ª</span>';
                    }
                } else {
                    statusElement.innerHTML = `<span class="status-error">–û—à–∏–±–∫–∞: ${data.description || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}</span>`;
                }
            } catch (error) {
                console.error('Error checking subscription:', error);
                statusElement.innerHTML = '<span class="status-error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</span>';
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
            checkBtn.innerHTML = '<i class="fas fa-sync-alt"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
            checkBtn.disabled = false;
            checkInProgress = false;
        }
        
        // –û—Ç–∫—Ä—ã—Ç—å –∫–∞–Ω–∞–ª
        function openChannel() {
            if (typeof window.Telegram !== 'undefined' && window.Telegram.WebApp && window.Telegram.WebApp.openTelegramLink) {
                window.Telegram.WebApp.openTelegramLink(`https://t.me/${CHANNEL_USERNAME.substring(1)}`);
            } else {
                window.open(`https://t.me/${CHANNEL_USERNAME.substring(1)}`, '_blank');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä (–∑–∞–≥–ª—É—à–∫–∞)
        function loadGames() {
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä...');
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤–∞—à–∞ –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä –∏–∑ script.js
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –°–Ω–∞—á–∞–ª–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∫–∏
            initTelegram();
            
            // –ó–∞—Ç–µ–º –∑–∞–≥—Ä—É–∂–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
            if (typeof loadGames === 'function') {
                // –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è loadGames —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ script.js
                loadGames();
            } else {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
                const script = document.createElement('script');
                script.src = 'script/script.js';
                script.onload = function() {
                    console.log('–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');
                };
                document.body.appendChild(script);
            }
        });
    </script>
    
    <script src="script/script.js"></script>
</body>
</html>
