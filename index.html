<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Button Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .config-section {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input, textarea, button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
        }

        input, textarea {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid transparent;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #0088cc;
        }

        button {
            background: #0088cc;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: bold;
        }

        button:hover {
            background: #0077b3;
        }

        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .button-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }

        .button-item button {
            margin-bottom: 10px;
            background: #28a745;
        }

        .button-item button:hover {
            background: #218838;
        }

        .delete-btn {
            background: #dc3545 !important;
            padding: 5px 10px;
            font-size: 12px;
            width: auto;
        }

        .delete-btn:hover {
            background: #c82333 !important;
        }

        .button-info {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            display: none;
        }

        .status.success {
            background: #28a745;
            display: block;
        }

        .status.error {
            background: #dc3545;
            display: block;
        }

        .status.loading {
            background: #ffc107;
            color: #333;
            display: block;
        }

        .github-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ GitHub Button Manager</h1>
        
        <div class="config-section">
            <h2>üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub</h2>
            <div class="form-group">
                <label for="githubToken">GitHub Personal Token</label>
                <input type="password" id="githubToken" placeholder="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">
                <small>–°–æ–∑–¥–∞–π—Ç–µ –≤ GitHub Settings ‚Üí Developer settings ‚Üí Personal access tokens</small>
            </div>
            <div class="form-group">
                <label for="repoOwner">–í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</label>
                <input type="text" id="repoOwner" placeholder="your-username">
            </div>
            <div class="form-group">
                <label for="repoName">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</label>
                <input type="text" id="repoName" placeholder="my-buttons-repo">
            </div>
            <button onclick="saveConfig()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>

        <div class="config-section">
            <h2>‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–Ω–æ–ø–∫—É</h2>
            <div class="form-group">
                <label for="buttonText">–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏</label>
                <input type="text" id="buttonText" placeholder="–ú–æ—è –∫–Ω–æ–ø–∫–∞">
            </div>
            <div class="form-group">
                <label for="buttonUrl">URL –∫–Ω–æ–ø–∫–∏</label>
                <input type="url" id="buttonUrl" placeholder="https://example.com">
            </div>
            <div class="form-group">
                <label for="buttonColor">–¶–≤–µ—Ç –∫–Ω–æ–ø–∫–∏</label>
                <input type="color" id="buttonColor" value="#0088cc">
            </div>
            <button onclick="createButton()">üéØ –°–æ–∑–¥–∞—Ç—å –∫–Ω–æ–ø–∫—É –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ GitHub</button>
        </div>

        <div id="status" class="status"></div>

        <h2>üéÆ –í–∞—à–∏ –∫–Ω–æ–ø–∫–∏</h2>
        <div id="buttonsGrid" class="buttons-grid">
            <!-- –ö–Ω–æ–ø–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
        </div>

        <div class="github-info">
            <h3>üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h3>
            <ol>
                <li>–°–æ–∑–¥–∞–π—Ç–µ Personal Access Token –≤ GitHub —Å –ø—Ä–∞–≤–∞–º–∏ repo</li>
                <li>–°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫</li>
                <li>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã—à–µ</li>
                <li>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ - –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ GitHub</li>
            </ol>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        let config = {
            token: '',
            repoOwner: '',
            repoName: ''
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            loadConfig();
            loadButtonsFromGitHub();
        });

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        function saveConfig() {
            config.token = document.getElementById('githubToken').value;
            config.repoOwner = document.getElementById('repoOwner').value;
            config.repoName = document.getElementById('repoName').value;
            
            localStorage.setItem('githubButtonConfig', JSON.stringify(config));
            showStatus('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        function loadConfig() {
            const savedConfig = localStorage.getItem('githubButtonConfig');
            if (savedConfig) {
                config = JSON.parse(savedConfig);
                document.getElementById('githubToken').value = config.token;
                document.getElementById('repoOwner').value = config.repoOwner;
                document.getElementById('repoName').value = config.repoName;
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
        function showStatus(message, type = 'success') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
        async function createButton() {
            if (!validateConfig()) return;

            const buttonText = document.getElementById('buttonText').value;
            const buttonUrl = document.getElementById('buttonUrl').value;
            const buttonColor = document.getElementById('buttonColor').value;

            if (!buttonText || !buttonUrl) {
                showStatus('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }

            showStatus('‚è≥ –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ GitHub...', 'loading');

            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫–Ω–æ–ø–∫–∏
                const currentButtons = await getButtonsFromGitHub();
                
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–Ω–æ–ø–∫—É
                const newButton = {
                    id: Date.now(),
                    text: buttonText,
                    url: buttonUrl,
                    color: buttonColor,
                    created: new Date().toISOString()
                };

                // –î–æ–±–∞–≤–ª—è–µ–º –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º
                currentButtons.push(newButton);

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ GitHub
                await saveButtonsToGitHub(currentButtons);

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                renderButtons(currentButtons);

                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('buttonText').value = '';
                document.getElementById('buttonUrl').value = '';

                showStatus('‚úÖ –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ GitHub!', 'success');
            } catch (error) {
                showStatus('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
        async function deleteButton(buttonId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–Ω–æ–ø–∫—É?')) return;

            if (!validateConfig()) return;

            showStatus('‚è≥ –£–¥–∞–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏–∑ GitHub...', 'loading');

            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫–Ω–æ–ø–∫–∏
                const currentButtons = await getButtonsFromGitHub();
                
                // –£–¥–∞–ª—è–µ–º –∫–Ω–æ–ø–∫—É
                const updatedButtons = currentButtons.filter(button => button.id !== buttonId);

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ GitHub
                await saveButtonsToGitHub(updatedButtons);

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                renderButtons(updatedButtons);

                showStatus('‚úÖ –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ GitHub!', 'success');
            } catch (error) {
                showStatus('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –∏–∑ GitHub
        async function getButtonsFromGitHub() {
            try {
                const response = await fetch(
                    `https://api.github.com/repos/${config.repoOwner}/${config.repoName}/contents/buttons.json`,
                    {
                        headers: {
                            'Authorization': `token ${config.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );

                if (response.status === 404) {
                    // –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
                    return [];
                }

                if (!response.ok) {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–Ω–æ–ø–∫–∏');
                }

                const data = await response.json();
                const content = atob(data.content);
                return JSON.parse(content);
            } catch (error) {
                console.error('Error loading buttons:', error);
                return [];
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ GitHub
        async function saveButtonsToGitHub(buttons) {
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π SHA —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
            let sha = '';
            try {
                const currentFile = await fetch(
                    `https://api.github.com/repos/${config.repoOwner}/${config.repoName}/contents/buttons.json`,
                    {
                        headers: {
                            'Authorization': `token ${config.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );
                
                if (currentFile.ok) {
                    const data = await currentFile.json();
                    sha = data.sha;
                }
            } catch (error) {
                // –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
            }

            const response = await fetch(
                `https://api.github.com/repos/${config.repoOwner}/${config.repoName}/contents/buttons.json`,
                {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${config.token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `Update buttons: ${new Date().toLocaleString()}`,
                        content: btoa(JSON.stringify(buttons, null, 2)),
                        sha: sha
                    })
                }
            );

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
            }

            return await response.json();
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        async function loadButtonsFromGitHub() {
            if (!validateConfig(true)) return;

            try {
                const buttons = await getButtonsFromGitHub();
                renderButtons(buttons);
            } catch (error) {
                console.error('Error loading buttons:', error);
            }
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–Ω–æ–ø–∫–∏
        function renderButtons(buttons) {
            const grid = document.getElementById('buttonsGrid');
            grid.innerHTML = '';

            if (buttons.length === 0) {
                grid.innerHTML = '<p>–ö–Ω–æ–ø–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é!</p>';
                return;
            }

            buttons.forEach(button => {
                const buttonElement = document.createElement('div');
                buttonElement.className = 'button-item';
                buttonElement.innerHTML = `
                    <button style="background: ${button.color}" onclick="window.open('${button.url}', '_blank')">
                        ${button.text}
                    </button>
                    <div class="button-info">
                        ID: ${button.id}<br>
                        –°–æ–∑–¥–∞–Ω–∞: ${new Date(button.created).toLocaleDateString()}
                    </div>
                    <button class="delete-btn" onclick="deleteButton(${button.id})">
                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                    </button>
                `;
                grid.appendChild(buttonElement);
            });
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        function validateConfig(silent = false) {
            if (!config.token || !config.repoOwner || !config.repoName) {
                if (!silent) {
                    showStatus('‚ùå –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitHub', 'error');
                }
                return false;
            }
            return true;
        }
    </script>
</body>
</html>
